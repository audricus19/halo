{"ast":null,"code":"import _regeneratorRuntime from \"@babel/runtime/regenerator\";\n\nvar _InterestsEditModal_m,\n    _jsxFileName = \"/Volumes/Work/work/dev/project/projects/halo/app/javascript/src/marketplace/components/Sidebar/InterestsEditModal.jsx\";\n\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\nfunction _defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } }\n\nfunction _createClass(Constructor, protoProps, staticProps) { if (protoProps) _defineProperties(Constructor.prototype, protoProps); if (staticProps) _defineProperties(Constructor, staticProps); return Constructor; }\n\nfunction _possibleConstructorReturn(self, call) { if (call && (typeof call === \"object\" || typeof call === \"function\")) { return call; } return _assertThisInitialized(self); }\n\nfunction _assertThisInitialized(self) { if (self === void 0) { throw new ReferenceError(\"this hasn't been initialised - super() hasn't been called\"); } return self; }\n\nfunction _getPrototypeOf(o) { _getPrototypeOf = Object.setPrototypeOf ? Object.getPrototypeOf : function _getPrototypeOf(o) { return o.__proto__ || Object.getPrototypeOf(o); }; return _getPrototypeOf(o); }\n\nfunction _inherits(subClass, superClass) { if (typeof superClass !== \"function\" && superClass !== null) { throw new TypeError(\"Super expression must either be null or a function\"); } subClass.prototype = Object.create(superClass && superClass.prototype, { constructor: { value: subClass, writable: true, configurable: true } }); if (superClass) _setPrototypeOf(subClass, superClass); }\n\nfunction _setPrototypeOf(o, p) { _setPrototypeOf = Object.setPrototypeOf || function _setPrototypeOf(o, p) { o.__proto__ = p; return o; }; return _setPrototypeOf(o, p); }\n\nfunction _defineProperty(obj, key, value) { if (key in obj) { Object.defineProperty(obj, key, { value: value, enumerable: true, configurable: true, writable: true }); } else { obj[key] = value; } return obj; }\n\nimport React, { PureComponent } from 'react';\nimport PropTypes from 'prop-types';\nimport { connect } from 'react-redux';\nimport { css, StyleSheet } from 'aphrodite';\nimport { Modal, Button, Dropdown, Icon } from 'semantic-ui-react';\nimport _, { debounce } from 'lodash';\nimport classnames from \"classnames\";\nimport { COLORS } from '../../../../constants';\nimport { authenticityToken } from '../../utils/requests';\nvar styles = StyleSheet.create({\n  InterestsEditModal_modal: {\n    overflow: 'visible'\n  },\n  InterestsEditModal_modalFieldLabel: {\n    textAlign: 'left',\n    margin: '10px 0 6px',\n    width: '100%',\n    fontSize: '12px',\n    fontWeight: 500,\n    lineHeight: '16px',\n    color: COLORS.labelGray\n  },\n  InterestsEditModal_modalTextArea: {\n    width: '100%',\n    margin: 'auto',\n    padding: '10px',\n    fontSize: '14px',\n    lineHeight: '20px'\n  },\n  InterestsEditModal_modalSubmitButton: {\n    background: COLORS.lightBlue,\n    backgroundImage: 'linear-gradient(134.72deg, #4E9DF5 0%, #48B2F4 100%)',\n    display: 'inline-block',\n    height: '48px',\n    textAlign: 'center',\n    color: COLORS.white,\n    fontSize: '14px',\n    fontWeight: 500,\n    lineHeight: '20px',\n    padding: '5px 50px'\n  },\n  InterestsEditModal_modalButtonHolder: (_InterestsEditModal_m = {\n    width: '100%',\n    display: 'inline-block',\n    textAlign: 'right',\n    marginTop: '36px',\n    height: '200px'\n  }, _defineProperty(_InterestsEditModal_m, \"display\", 'flex'), _defineProperty(_InterestsEditModal_m, \"alignItems\", 'flex-end'), _defineProperty(_InterestsEditModal_m, \"justifyContent\", 'flex-end'), _InterestsEditModal_m),\n  InterestsEditModal_modalCancelButton: {\n    height: '48px',\n    textAlign: 'center',\n    color: COLORS.lightBlack,\n    backgroundColor: COLORS.white,\n    display: 'inline-block',\n    fontSize: '14px',\n    fontWeight: 500,\n    lineHeight: '20px',\n    padding: '5px 50px'\n  },\n  InterestsEditModal_dropdown: {\n    width: '100%',\n    display: 'flex',\n    flexWrap: 'wrap',\n    alignItems: 'center',\n    borderStyle: 'solid',\n    borderWidth: '1px',\n    borderColor: COLORS.gray,\n    margin: 'auto',\n    fontSize: '14px'\n  },\n  InterestsEditModal_searchDropdown: {\n    fontSize: '14px',\n    minHeight: '48px',\n    paddingTop: '8px'\n  },\n  InterestsEditModal_searchIcon: {\n    width: '10%',\n    height: '48px',\n    paddingTop: '8px',\n    fontSize: '24px',\n    color: COLORS.lightGray,\n    backgroundColor: COLORS.transparentDarkGray,\n    justifyContent: 'center',\n    display: 'flex'\n  },\n  InterestsEditModal_searchContainer: {\n    display: 'flex'\n  }\n});\n\nvar InterestsEditModal =\n/*#__PURE__*/\nfunction (_PureComponent) {\n  _inherits(InterestsEditModal, _PureComponent);\n\n  function InterestsEditModal(props) {\n    var _this;\n\n    _classCallCheck(this, InterestsEditModal);\n\n    _this = _possibleConstructorReturn(this, _getPrototypeOf(InterestsEditModal).call(this, props));\n\n    _this.handleKeywords = function (e, selection) {\n      _this.setState(function (prevState) {\n        if (selection.value.length > 6) {\n          return {\n            keywords: prevState.keywords,\n            searchQuery: ''\n          };\n        } else {\n          return {\n            keywords: selection.value || [],\n            searchQuery: ''\n          };\n        }\n      });\n    };\n\n    _this.handleSearchQuery = function (options, query) {\n      var _this$state = _this.state,\n          keywords = _this$state.keywords,\n          keywordSearchOptions = _this$state.keywordSearchOptions;\n\n      var searchOptions = _.uniqBy(keywordSearchOptions.concat(keywords.map(function (keyword) {\n        return {\n          key: keyword,\n          text: keyword,\n          value: keyword\n        };\n      })), 'key');\n\n      return searchOptions;\n    };\n\n    _this.keywordSearch = debounce(function _callee(researchType) {\n      var keywords, response, responseJson, researchKeywords;\n      return _regeneratorRuntime.async(function _callee$(_context) {\n        while (1) {\n          switch (_context.prev = _context.next) {\n            case 0:\n              keywords = _this.state.keywords;\n\n              _this.setState({\n                loadingSearch: true\n              });\n\n              _context.next = 4;\n              return _regeneratorRuntime.awrap(fetch(\"/research_keywords/search?research_type=\".concat(researchType), {\n                method: 'GET',\n                headers: {\n                  'Accept': 'application/json'\n                }\n              }));\n\n            case 4:\n              response = _context.sent;\n              _context.next = 7;\n              return _regeneratorRuntime.awrap(response.json());\n\n            case 7:\n              responseJson = _context.sent;\n              researchKeywords = responseJson.research_keywords;\n\n              _this.setState({\n                keywordSearchOptions: _.uniqBy(researchKeywords.concat(keywords.map(function (keyword) {\n                  return {\n                    key: keyword,\n                    text: keyword,\n                    value: keyword\n                  };\n                })), 'key'),\n                loadingSearch: false\n              });\n\n            case 10:\n            case \"end\":\n              return _context.stop();\n          }\n        }\n      });\n    }, 500, {\n      leading: true,\n      trailing: true\n    });\n\n    _this.handleSearchChange = function _callee2(e, _ref) {\n      var searchQuery;\n      return _regeneratorRuntime.async(function _callee2$(_context2) {\n        while (1) {\n          switch (_context2.prev = _context2.next) {\n            case 0:\n              searchQuery = _ref.searchQuery;\n\n              _this.keywordSearch(searchQuery);\n\n              _this.setState({\n                searchQuery: searchQuery\n              });\n\n            case 3:\n            case \"end\":\n              return _context2.stop();\n          }\n        }\n      });\n    };\n\n    _this.handleSubmitMessage = function _callee3(e) {\n      var _this$props, closeModal, currentUser, keywords, formData, textResponse, responseJson;\n\n      return _regeneratorRuntime.async(function _callee3$(_context3) {\n        while (1) {\n          switch (_context3.prev = _context3.next) {\n            case 0:\n              _this$props = _this.props, closeModal = _this$props.closeModal, currentUser = _this$props.currentUser;\n              e.preventDefault();\n              keywords = _this.state.keywords;\n\n              _this.setState({\n                interestsEditModalLoading: true\n              });\n\n              formData = new FormData();\n              formData.append('keywords', keywords);\n              formData.append('user_id', currentUser.id);\n              _context3.prev = 7;\n              _context3.next = 10;\n              return _regeneratorRuntime.awrap(fetch(\"/user_profile_infos/\".concat(currentUser.id), {\n                method: 'PUT',\n                body: formData,\n                headers: {\n                  'Accept': 'application/json',\n                  'X-CSRF-Token': authenticityToken()\n                }\n              }));\n\n            case 10:\n              textResponse = _context3.sent;\n              _context3.next = 13;\n              return _regeneratorRuntime.awrap(textResponse.json());\n\n            case 13:\n              responseJson = _context3.sent;\n\n              if (!responseJson.success) {\n                _this.setState({\n                  interestsEditModalLoading: false\n                });\n              } else {\n                _this.setState({\n                  interestsEditModalLoading: false\n                });\n\n                window.location.reload();\n              }\n\n              _context3.next = 20;\n              break;\n\n            case 17:\n              _context3.prev = 17;\n              _context3.t0 = _context3[\"catch\"](7);\n\n              _this.setState({\n                interestsEditModalLoading: false\n              });\n\n            case 20:\n            case \"end\":\n              return _context3.stop();\n          }\n        }\n      }, null, null, [[7, 17]]);\n    };\n\n    _this.state = {\n      interestsEditModalLoading: false,\n      keywords: props.currentUser.keywords,\n      searchQuery: '',\n      loadingSearch: false,\n      keywordSearchOptions: props.currentUser.keywords && props.currentUser.keywords.length > 0 ? _.uniqBy(props.currentUser.keywords.map(function (keyword) {\n        return {\n          key: keyword,\n          text: keyword,\n          value: keyword\n        };\n      }), 'key') : []\n    };\n    return _this;\n  }\n\n  _createClass(InterestsEditModal, [{\n    key: \"componentDidUpdate\",\n    value: function componentDidUpdate(prevProps) {\n      if (prevProps.currentUser !== this.props.currentUser) {\n        this.setState({\n          keywords: this.props.currentUser.keywords,\n          keywordSearchOptions: this.props.currentUser.keywords && this.props.currentUser.keywords.length > 0 ? _.uniqBy(this.props.currentUser.keywords.map(function (keyword) {\n            return {\n              key: keyword,\n              text: keyword,\n              value: keyword\n            };\n          }), 'key') : []\n        });\n      }\n    }\n  }, {\n    key: \"render\",\n    value: function render() {\n      var _this2 = this;\n\n      var _this$props2 = this.props,\n          open = _this$props2.open,\n          proposal = _this$props2.proposal,\n          closeModal = _this$props2.closeModal;\n      var _this$state2 = this.state,\n          keywords = _this$state2.keywords,\n          interestsEditModalLoading = _this$state2.interestsEditModalLoading,\n          searchQuery = _this$state2.searchQuery,\n          loadingSearch = _this$state2.loadingSearch,\n          keywordSearchOptions = _this$state2.keywordSearchOptions;\n      var validKeywords = keywords && keywords.length > 0 && !loadingSearch && !interestsEditModalLoading;\n      return React.createElement(Modal, {\n        open: open,\n        onClose: closeModal,\n        size: \"small\",\n        closeOnDimmerClick: false,\n        className: \"\".concat(css(styles.InterestsEditModal_modal), \" scrolling\"),\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 256\n        },\n        __self: this\n      }, React.createElement(Modal.Content, {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 263\n        },\n        __self: this\n      }, React.createElement(\"div\", {\n        className: css(styles.InterestsEditModal_modalFieldLabel),\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 264\n        },\n        __self: this\n      }, \"Interests\"), React.createElement(\"div\", {\n        className: classnames(css(styles.InterestsEditModal_searchContainer), \"onboarding-dropdown\"),\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 267\n        },\n        __self: this\n      }, React.createElement(Dropdown, {\n        className: css(styles.InterestsEditModal_searchDropdown),\n        placeholder: \"Search for keywords\",\n        fluid: true,\n        selection: true,\n        multiple: true,\n        icon: \"search\",\n        search: this.handleSearchQuery,\n        value: keywords,\n        open: searchQuery.length > 0 && this.state.keywordSearchOpen,\n        onBlur: function onBlur() {\n          return _this2.setState({\n            keywordSearchOpen: false\n          });\n        },\n        onFocus: function onFocus() {\n          return _this2.setState({\n            keywordSearchOpen: true\n          });\n        },\n        searchQuery: searchQuery,\n        options: keywordSearchOptions,\n        onChange: this.handleKeywords,\n        onSearchChange: this.handleSearchChange,\n        loading: loadingSearch,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 268\n        },\n        __self: this\n      })), React.createElement(\"div\", {\n        className: css(styles.InterestsEditModal_modalButtonHolder),\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 287\n        },\n        __self: this\n      }, React.createElement(Button, {\n        className: css(styles.InterestsEditModal_modalCancelButton),\n        type: \"submit\",\n        onClick: closeModal,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 288\n        },\n        __self: this\n      }, \"Cancel\"), React.createElement(Button, {\n        className: css(styles.InterestsEditModal_modalSubmitButton),\n        type: \"submit\",\n        disabled: !validKeywords,\n        onClick: this.handleSubmitMessage,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 295\n        },\n        __self: this\n      }, \"Save\"))));\n    }\n  }]);\n\n  return InterestsEditModal;\n}(PureComponent);\n\nInterestsEditModal.propTypes = {\n  currentUser: PropTypes.object,\n  open: PropTypes.bool,\n  closeModal: PropTypes.func\n};\nexport default InterestsEditModal;","map":{"version":3,"sources":["/Volumes/Work/work/dev/project/projects/halo/app/javascript/src/marketplace/components/Sidebar/InterestsEditModal.jsx"],"names":["React","PureComponent","PropTypes","connect","css","StyleSheet","Modal","Button","Dropdown","Icon","_","debounce","classnames","COLORS","authenticityToken","styles","create","InterestsEditModal_modal","overflow","InterestsEditModal_modalFieldLabel","textAlign","margin","width","fontSize","fontWeight","lineHeight","color","labelGray","InterestsEditModal_modalTextArea","padding","InterestsEditModal_modalSubmitButton","background","lightBlue","backgroundImage","display","height","white","InterestsEditModal_modalButtonHolder","marginTop","InterestsEditModal_modalCancelButton","lightBlack","backgroundColor","InterestsEditModal_dropdown","flexWrap","alignItems","borderStyle","borderWidth","borderColor","gray","InterestsEditModal_searchDropdown","minHeight","paddingTop","InterestsEditModal_searchIcon","lightGray","transparentDarkGray","justifyContent","InterestsEditModal_searchContainer","InterestsEditModal","props","handleKeywords","e","selection","setState","prevState","value","length","keywords","searchQuery","handleSearchQuery","options","query","state","keywordSearchOptions","searchOptions","uniqBy","concat","map","keyword","key","text","keywordSearch","researchType","loadingSearch","fetch","method","headers","response","json","responseJson","researchKeywords","research_keywords","leading","trailing","handleSearchChange","handleSubmitMessage","closeModal","currentUser","preventDefault","interestsEditModalLoading","formData","FormData","append","id","body","textResponse","success","window","location","reload","prevProps","open","proposal","validKeywords","keywordSearchOpen","propTypes","object","bool","func"],"mappings":"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","sourcesContent":["import React, { PureComponent } from 'react';\nimport PropTypes from 'prop-types';\nimport { connect } from 'react-redux';\nimport { css, StyleSheet } from 'aphrodite';\nimport { Modal, Button, Dropdown, Icon } from 'semantic-ui-react';\nimport _, { debounce } from 'lodash';\nimport classnames from \"classnames\";\n\nimport { COLORS } from '../../../../constants';\nimport {\n  authenticityToken,\n} from '../../utils/requests';\n\nconst styles = StyleSheet.create({\n  InterestsEditModal_modal: {\n    overflow: 'visible',\n  },\n  InterestsEditModal_modalFieldLabel: {\n    textAlign: 'left',\n    margin: '10px 0 6px',\n    width: '100%',\n    fontSize: '12px',\n    fontWeight: 500,\n    lineHeight: '16px',\n    color: COLORS.labelGray,\n  },\n  InterestsEditModal_modalTextArea: {\n    width: '100%',\n    margin: 'auto',\n    padding: '10px',\n    fontSize: '14px',\n    lineHeight: '20px',\n  },\n  InterestsEditModal_modalSubmitButton: {\n    background: COLORS.lightBlue,\n    backgroundImage: 'linear-gradient(134.72deg, #4E9DF5 0%, #48B2F4 100%)',\n    display: 'inline-block',\n    height: '48px',\n    textAlign: 'center',\n    color: COLORS.white,\n    fontSize: '14px',\n    fontWeight: 500,\n    lineHeight: '20px',\n    padding: '5px 50px',\n  },\n  InterestsEditModal_modalButtonHolder: {\n    width: '100%',\n    display: 'inline-block',\n    textAlign: 'right',\n    marginTop: '36px',\n    height: '200px',\n    display: 'flex',\n    alignItems: 'flex-end',\n    justifyContent: 'flex-end',\n  },\n  InterestsEditModal_modalCancelButton: {\n    height: '48px',\n    textAlign: 'center',\n    color: COLORS.lightBlack,\n    backgroundColor: COLORS.white,\n    display: 'inline-block',\n    fontSize: '14px',\n    fontWeight: 500,\n    lineHeight: '20px',\n    padding: '5px 50px',\n  },\n  InterestsEditModal_dropdown: {\n    width: '100%',\n    display: 'flex',\n    flexWrap: 'wrap',\n    alignItems: 'center',\n    borderStyle: 'solid',\n    borderWidth: '1px',\n    borderColor: COLORS.gray,\n    margin: 'auto',\n    fontSize: '14px',\n  },\n  InterestsEditModal_searchDropdown: {\n    fontSize: '14px',\n    minHeight: '48px',\n    paddingTop: '8px',\n  },\n  InterestsEditModal_searchIcon: {\n    width: '10%',\n    height: '48px',\n    paddingTop: '8px',\n    fontSize: '24px',\n    color: COLORS.lightGray,\n    backgroundColor: COLORS.transparentDarkGray,\n    justifyContent: 'center',\n    display: 'flex',\n  },\n  InterestsEditModal_searchContainer: {\n    display: 'flex',\n  },\n});\n\nclass InterestsEditModal extends PureComponent {\n  constructor(props) {\n    super(props);\n    this.state = {\n      interestsEditModalLoading: false,\n      keywords: props.currentUser.keywords,\n      searchQuery: '',\n      loadingSearch: false,\n      keywordSearchOptions: props.currentUser.keywords && props.currentUser.keywords.length > 0 ? _.uniqBy(props.currentUser.keywords.map((keyword) => {\n        return {\n          key: keyword,\n          text: keyword,\n          value: keyword,\n        };\n      }), 'key') : [],\n    };\n  }\n\n  componentDidUpdate(prevProps) {\n    if (prevProps.currentUser !== this.props.currentUser) {\n      this.setState({\n        keywords: this.props.currentUser.keywords,\n        keywordSearchOptions: this.props.currentUser.keywords && this.props.currentUser.keywords.length > 0 ? _.uniqBy(this.props.currentUser.keywords.map((keyword) => {\n          return {\n            key: keyword,\n            text: keyword,\n            value: keyword,\n          };\n        }), 'key') : [],\n      });\n    }\n  }\n\n  handleKeywords = (e, selection) => {\n    this.setState((prevState) => {\n      if (selection.value.length > 6) {\n        return {\n          keywords: prevState.keywords,\n          searchQuery: '',\n        };\n      } else {\n        return {\n          keywords: selection.value || [],\n          searchQuery: '',\n        };\n      }\n    });\n  };\n\n  handleSearchQuery = (options, query) => {\n    const {\n      keywords,\n      keywordSearchOptions,\n    } = this.state;\n    const searchOptions = _.uniqBy(keywordSearchOptions.concat(keywords.map((keyword) => {\n      return {\n        key: keyword,\n        text: keyword,\n        value: keyword,\n      };\n    })), 'key');\n    return searchOptions;\n  }\n\n  keywordSearch = debounce(async (researchType) => {\n    const { keywords } = this.state;\n    this.setState({ loadingSearch: true });\n    const response = await fetch(`/research_keywords/search?research_type=${researchType}`, {\n      method: 'GET',\n      headers: {\n        'Accept': 'application/json',\n      }\n    });\n    const responseJson = await response.json();\n    const researchKeywords = responseJson.research_keywords;\n\n    this.setState({\n      keywordSearchOptions: _.uniqBy(researchKeywords.concat(keywords.map((keyword) => {\n        return {\n          key: keyword,\n          text: keyword,\n          value: keyword,\n        };\n      })), 'key'),\n      loadingSearch: false,\n    });\n  }, 500, { leading: true, trailing: true });\n\n  handleSearchChange = async (e, { searchQuery }) => {\n    this.keywordSearch(searchQuery);\n\n    this.setState({\n      searchQuery,\n    });\n  };\n\n  handleSubmitMessage = async (e) => {\n    const {\n      closeModal,\n      currentUser,\n    } = this.props;\n\n    e.preventDefault();\n\n    const {\n      keywords,\n    } = this.state;\n\n    this.setState({\n      interestsEditModalLoading: true,\n    });\n\n    const formData = new FormData();\n    formData.append('keywords', keywords);\n    formData.append('user_id', currentUser.id);\n\n    try {\n      const textResponse = await fetch(`/user_profile_infos/${currentUser.id}`, {\n        method: 'PUT',\n        body: formData,\n        headers: {\n          'Accept': 'application/json',\n          'X-CSRF-Token': authenticityToken(),\n        }\n      });\n      const responseJson = await textResponse.json();\n      if (!responseJson.success) {\n        this.setState({\n          interestsEditModalLoading: false,\n        });\n      } else {\n        this.setState({\n          interestsEditModalLoading: false,\n        });\n        window.location.reload();\n      }\n    } catch(err) {\n      this.setState({ interestsEditModalLoading: false });\n    }\n  }\n\n  render() {\n    const {\n      open,\n      proposal,\n      closeModal,\n    } = this.props;\n\n    const {\n      keywords,\n      interestsEditModalLoading,\n      searchQuery,\n      loadingSearch,\n      keywordSearchOptions,\n    } = this.state;\n\n    const validKeywords = keywords && keywords.length > 0 && !loadingSearch && !interestsEditModalLoading;\n    return (\n      <Modal\n        open={open}\n        onClose={closeModal}\n        size=\"small\"\n        closeOnDimmerClick={false}\n        className={`${css(styles.InterestsEditModal_modal)} scrolling`}\n      >\n        <Modal.Content>\n          <div className={css(styles.InterestsEditModal_modalFieldLabel)}>\n            Interests\n          </div>\n          <div className={classnames(css(styles.InterestsEditModal_searchContainer), \"onboarding-dropdown\")}>\n            <Dropdown\n              className={css(styles.InterestsEditModal_searchDropdown)}\n              placeholder='Search for keywords'\n              fluid\n              selection\n              multiple\n              icon='search'\n              search={this.handleSearchQuery}\n              value={keywords}\n              open={searchQuery.length > 0 && this.state.keywordSearchOpen}\n              onBlur={() => this.setState({ keywordSearchOpen: false })}\n              onFocus={() => this.setState({ keywordSearchOpen: true })}\n              searchQuery={searchQuery}\n              options={keywordSearchOptions}\n              onChange={this.handleKeywords}\n              onSearchChange={this.handleSearchChange}\n              loading={loadingSearch}\n            />\n          </div>\n          <div className={css(styles.InterestsEditModal_modalButtonHolder)}>\n            <Button\n              className={css(styles.InterestsEditModal_modalCancelButton)}\n              type='submit'\n              onClick={closeModal}\n            >\n              Cancel\n            </Button>\n            <Button\n              className={css(styles.InterestsEditModal_modalSubmitButton)}\n              type='submit'\n              disabled={!validKeywords}\n              onClick={this.handleSubmitMessage}\n            >\n              Save\n            </Button>\n          </div>\n        </Modal.Content>\n      </Modal>\n    );\n  }\n}\n\nInterestsEditModal.propTypes = {\n  currentUser: PropTypes.object,\n  open: PropTypes.bool,\n  closeModal: PropTypes.func,\n};\n\nexport default InterestsEditModal;\n"]},"metadata":{},"sourceType":"module"}
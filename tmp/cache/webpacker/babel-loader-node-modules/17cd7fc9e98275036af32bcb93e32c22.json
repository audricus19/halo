{"ast":null,"code":"import _regeneratorRuntime from \"@babel/runtime/regenerator\";\nvar _jsxFileName = \"/Volumes/Work/work/dev/project/projects/halo/app/javascript/src/marketplace/components/Sidebar/EducationEditModal.jsx\";\n\nfunction _defineProperty(obj, key, value) { if (key in obj) { Object.defineProperty(obj, key, { value: value, enumerable: true, configurable: true, writable: true }); } else { obj[key] = value; } return obj; }\n\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\nfunction _defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } }\n\nfunction _createClass(Constructor, protoProps, staticProps) { if (protoProps) _defineProperties(Constructor.prototype, protoProps); if (staticProps) _defineProperties(Constructor, staticProps); return Constructor; }\n\nfunction _possibleConstructorReturn(self, call) { if (call && (typeof call === \"object\" || typeof call === \"function\")) { return call; } return _assertThisInitialized(self); }\n\nfunction _assertThisInitialized(self) { if (self === void 0) { throw new ReferenceError(\"this hasn't been initialised - super() hasn't been called\"); } return self; }\n\nfunction _getPrototypeOf(o) { _getPrototypeOf = Object.setPrototypeOf ? Object.getPrototypeOf : function _getPrototypeOf(o) { return o.__proto__ || Object.getPrototypeOf(o); }; return _getPrototypeOf(o); }\n\nfunction _inherits(subClass, superClass) { if (typeof superClass !== \"function\" && superClass !== null) { throw new TypeError(\"Super expression must either be null or a function\"); } subClass.prototype = Object.create(superClass && superClass.prototype, { constructor: { value: subClass, writable: true, configurable: true } }); if (superClass) _setPrototypeOf(subClass, superClass); }\n\nfunction _setPrototypeOf(o, p) { _setPrototypeOf = Object.setPrototypeOf || function _setPrototypeOf(o, p) { o.__proto__ = p; return o; }; return _setPrototypeOf(o, p); }\n\nimport React, { PureComponent } from 'react';\nimport PropTypes from 'prop-types';\nimport { connect } from 'react-redux';\nimport { css, StyleSheet } from 'aphrodite';\nimport { Modal, Button, Dropdown } from 'semantic-ui-react';\nimport moment from 'moment';\nimport _, { debounce } from 'lodash';\nimport { COLORS } from '../../../../constants';\nimport { styles as modalStyles } from '../Modal';\nimport { authenticityToken } from '../../utils/requests';\nvar styles = StyleSheet.create({\n  EducationEditModal_modal: {\n    overflow: 'visible'\n  },\n  EducationEditModal_modalHeader: {\n    fontWeight: 500,\n    fontSize: '24px',\n    lineHeight: '32px',\n    color: COLORS.lightBlack,\n    marginBottom: '32px'\n  },\n  EducationEditModal_modalFieldLabel: {\n    textAlign: 'left',\n    margin: '10px 0 6px',\n    width: '100%',\n    fontSize: '12px',\n    fontWeight: 500,\n    lineHeight: '16px',\n    color: COLORS.labelGray\n  },\n  EducationEditModal_modalTextInput: {\n    width: '100%',\n    margin: 'auto',\n    padding: '10px',\n    fontSize: '14px',\n    lineHeight: '20px',\n    borderStyle: 'solid',\n    borderWidth: '1px',\n    color: COLORS.lightBlack,\n    borderColor: COLORS.gray\n  },\n  EducationEditModal_modalSubmitButton: {\n    background: COLORS.lightBlue,\n    backgroundImage: 'linear-gradient(134.72deg, #4E9DF5 0%, #48B2F4 100%)',\n    display: 'inline-block',\n    height: '48px',\n    textAlign: 'center',\n    color: COLORS.white,\n    fontSize: '14px',\n    fontWeight: 500,\n    lineHeight: '20px',\n    padding: '5px 50px'\n  },\n  EducationEditModal_modalButtonHolder: {\n    width: '100%',\n    display: 'inline-block',\n    textAlign: 'right',\n    marginTop: '36px'\n  },\n  EducationEditModal_modalCancelButton: {\n    height: '48px',\n    textAlign: 'center',\n    color: COLORS.lightBlack,\n    backgroundColor: COLORS.white,\n    display: 'inline-block',\n    fontSize: '14px',\n    fontWeight: 500,\n    lineHeight: '20px',\n    padding: '5px 50px'\n  },\n  EducationEditModal_dropdown: {\n    width: '100%',\n    display: 'flex',\n    height: '48px',\n    alignItems: 'center',\n    borderStyle: 'solid',\n    borderWidth: '1px',\n    borderColor: COLORS.gray,\n    margin: 'auto',\n    fontSize: '14px'\n  }\n});\n\nvar yearOptions = _.range(new Date().getFullYear(), 1950, -1).map(function (year) {\n  return {\n    key: year,\n    text: year,\n    value: String(year)\n  };\n});\n\nvar EducationEditModal =\n/*#__PURE__*/\nfunction (_PureComponent) {\n  _inherits(EducationEditModal, _PureComponent);\n\n  function EducationEditModal(props) {\n    var _this;\n\n    _classCallCheck(this, EducationEditModal);\n\n    _this = _possibleConstructorReturn(this, _getPrototypeOf(EducationEditModal).call(this, props));\n\n    _this.fetchUniversities = function _callee() {\n      var response, responseJson, universities;\n      return _regeneratorRuntime.async(function _callee$(_context) {\n        while (1) {\n          switch (_context.prev = _context.next) {\n            case 0:\n              _this.setState({\n                loadingUniversities: true\n              });\n\n              _context.next = 3;\n              return _regeneratorRuntime.awrap(fetch('/universities', {\n                method: 'GET',\n                headers: {\n                  'Accept': 'application/json'\n                }\n              }));\n\n            case 3:\n              response = _context.sent;\n              _context.next = 6;\n              return _regeneratorRuntime.awrap(response.json());\n\n            case 6:\n              responseJson = _context.sent;\n              universities = responseJson.universities;\n\n              _this.setState({\n                universityOptions: universities,\n                loadingUniversities: false\n              });\n\n            case 9:\n            case \"end\":\n              return _context.stop();\n          }\n        }\n      });\n    };\n\n    _this.handleSubmitMessage = function _callee2(e) {\n      var _this$props, closeModal, degree, _this$state, location, startYear, endYear, isNew, fieldOfStudy, education, formData, educationResponse, responseJson;\n\n      return _regeneratorRuntime.async(function _callee2$(_context2) {\n        while (1) {\n          switch (_context2.prev = _context2.next) {\n            case 0:\n              _this$props = _this.props, closeModal = _this$props.closeModal, degree = _this$props.degree;\n              e.preventDefault();\n              _this$state = _this.state, location = _this$state.location, startYear = _this$state.startYear, endYear = _this$state.endYear, isNew = _this$state.isNew, fieldOfStudy = _this$state.fieldOfStudy;\n\n              _this.setState({\n                educationEditModalLoading: true\n              });\n\n              education = _this.props.education || {};\n              formData = new FormData();\n              formData.append('location', location);\n\n              if (degree) {\n                formData.append('degree', degree);\n              }\n\n              if (startYear) {\n                formData.append('start_year', startYear);\n              }\n\n              if (endYear) {\n                formData.append('end_year', endYear);\n              }\n\n              if (fieldOfStudy) {\n                formData.append('field_of_study', fieldOfStudy);\n              }\n\n              _context2.prev = 11;\n              _context2.next = 14;\n              return _regeneratorRuntime.awrap(fetch(isNew ? '/educations' : \"/educations/\".concat(education.id), {\n                method: isNew ? 'POST' : 'PUT',\n                body: formData,\n                headers: {\n                  'Accept': 'application/json',\n                  'X-CSRF-Token': authenticityToken()\n                }\n              }));\n\n            case 14:\n              educationResponse = _context2.sent;\n              _context2.next = 17;\n              return _regeneratorRuntime.awrap(educationResponse.json());\n\n            case 17:\n              responseJson = _context2.sent;\n\n              if (!responseJson.success) {\n                _this.setState({\n                  educationEditModalLoading: false\n                });\n              } else {\n                _this.setState({\n                  educationEditModalLoading: false\n                });\n\n                window.location.reload();\n              }\n\n              _context2.next = 24;\n              break;\n\n            case 21:\n              _context2.prev = 21;\n              _context2.t0 = _context2[\"catch\"](11);\n\n              _this.setState({\n                educationEditModalLoading: false\n              });\n\n            case 24:\n            case \"end\":\n              return _context2.stop();\n          }\n        }\n      }, null, null, [[11, 21]]);\n    };\n\n    _this.handleChange = function (e, attr) {\n      _this.setState(_defineProperty({}, attr, e.target.value));\n    };\n\n    _this.handleYears = function (e, selection, attr) {\n      _this.setState(_defineProperty({}, attr, selection.value));\n    };\n\n    _this.handleLocation = function (e, selection) {\n      _this.setState({\n        searchQuery: selection.value,\n        location: selection.value\n      });\n    };\n\n    _this.handleSearchQuery = function (options, query) {\n      var _this$state2 = _this.state,\n          universityOptions = _this$state2.universityOptions,\n          location = _this$state2.location;\n      return _.uniqBy([{\n        key: location,\n        text: location,\n        value: location\n      }].concat(universityOptions), 'value').filter(function (university) {\n        return university.value && university.value.length > 0;\n      });\n    };\n\n    _this.universitySearch = debounce(function _callee3(name) {\n      var response, responseJson, universities;\n      return _regeneratorRuntime.async(function _callee3$(_context3) {\n        while (1) {\n          switch (_context3.prev = _context3.next) {\n            case 0:\n              _this.setState({\n                loadingSearch: true\n              });\n\n              _context3.next = 3;\n              return _regeneratorRuntime.awrap(fetch(\"/universities/search?name=\".concat(name), {\n                method: 'GET',\n                headers: {\n                  'Accept': 'application/json'\n                }\n              }));\n\n            case 3:\n              response = _context3.sent;\n              _context3.next = 6;\n              return _regeneratorRuntime.awrap(response.json());\n\n            case 6:\n              responseJson = _context3.sent;\n              universities = responseJson.universities;\n\n              _this.setState({\n                location: '',\n                universityOptions: universities,\n                loadingSearch: false\n              });\n\n            case 9:\n            case \"end\":\n              return _context3.stop();\n          }\n        }\n      });\n    }, 500, {\n      leading: true,\n      trailing: true\n    });\n\n    _this.handleSearchChange = function _callee4(e, _ref) {\n      var searchQuery;\n      return _regeneratorRuntime.async(function _callee4$(_context4) {\n        while (1) {\n          switch (_context4.prev = _context4.next) {\n            case 0:\n              searchQuery = _ref.searchQuery;\n\n              _this.universitySearch(searchQuery);\n\n              _this.setState({\n                searchQuery: searchQuery\n              });\n\n            case 3:\n            case \"end\":\n              return _context4.stop();\n          }\n        }\n      });\n    };\n\n    _this.deleteEducation = function _callee5() {\n      return _regeneratorRuntime.async(function _callee5$(_context5) {\n        while (1) {\n          switch (_context5.prev = _context5.next) {\n            case 0:\n              if (!confirm(\"Are you sure you want to delete that?\")) {\n                _context5.next = 4;\n                break;\n              }\n\n              _context5.next = 3;\n              return _regeneratorRuntime.awrap(fetch(\"/educations/\".concat(_this.props.education.id), {\n                method: 'DELETE',\n                headers: {\n                  'Accept': 'application/json',\n                  'X-CSRF-Token': authenticityToken()\n                }\n              }));\n\n            case 3:\n              window.location.reload();\n\n            case 4:\n            case \"end\":\n              return _context5.stop();\n          }\n        }\n      });\n    };\n\n    var _education = props.education || {};\n\n    _this.state = {\n      isNew: _.isEmpty(_education),\n      educationEditModalLoading: false,\n      loadingUniversities: false,\n      universityOptions: _education.location ? [{\n        key: _education.location,\n        value: _education.location,\n        text: _education.location\n      }] : [],\n      location: _education.location,\n      startYear: _education.start_year,\n      endYear: _education.end_year,\n      searchQuery: _education.location ? _education.location : '',\n      fieldOfStudy: _education.field_of_study\n    };\n    return _this;\n  }\n\n  _createClass(EducationEditModal, [{\n    key: \"componentDidUpdate\",\n    value: function componentDidUpdate(prevProps) {\n      if (prevProps.education !== this.props.education) {\n        var education = this.props.education || {};\n        this.setState({\n          isNew: _.isEmpty(education),\n          universityOptions: education.location ? [{\n            key: education.location,\n            value: education.location,\n            text: education.location\n          }] : [],\n          location: education.location,\n          startYear: education.start_year,\n          endYear: education.end_year,\n          searchQuery: education.location ? education.location : '',\n          fieldOfStudy: education.field_of_study\n        });\n      }\n    }\n  }, {\n    key: \"render\",\n    value: function render() {\n      var _this2 = this;\n\n      var _this$props2 = this.props,\n          open = _this$props2.open,\n          degree = _this$props2.degree,\n          closeModal = _this$props2.closeModal,\n          education = _this$props2.education;\n      var _this$state3 = this.state,\n          location = _this$state3.location,\n          startYear = _this$state3.startYear,\n          endYear = _this$state3.endYear,\n          loadingUniversities = _this$state3.loadingUniversities,\n          universityOptions = _this$state3.universityOptions,\n          isNew = _this$state3.isNew,\n          educationEditModalLoading = _this$state3.educationEditModalLoading,\n          loadingSearch = _this$state3.loadingSearch,\n          searchQuery = _this$state3.searchQuery,\n          fieldOfStudy = _this$state3.fieldOfStudy;\n      var validEducation = location && !loadingUniversities && !educationEditModalLoading;\n      var inEditMode = !!education;\n      return React.createElement(Modal, {\n        open: open,\n        onClose: closeModal,\n        size: \"small\",\n        closeOnDimmerClick: false,\n        className: \"\".concat(css(styles.EducationEditModal_modal), \" scrolling\"),\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 296\n        },\n        __self: this\n      }, React.createElement(Modal.Content, {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 303\n        },\n        __self: this\n      }, React.createElement(\"div\", {\n        className: css(styles.EducationEditModal_modalHeader),\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 304\n        },\n        __self: this\n      }, \"Add \", degree === 'Postdoctoral Scientist' ? \"Postdoc\" : degree), React.createElement(\"div\", {\n        className: css(styles.EducationEditModal_modalFieldLabel),\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 307\n        },\n        __self: this\n      }, \"Research Institution\"), React.createElement(Dropdown, {\n        className: css(styles.EducationEditModal_dropdown),\n        fluid: true,\n        selection: true,\n        icon: null,\n        placeholder: \"Search research institutions\",\n        open: universityOptions.length > 0 && !location,\n        closeOnChange: true,\n        search: this.handleSearchQuery,\n        value: location || '',\n        options: universityOptions,\n        onChange: this.handleLocation,\n        searchQuery: searchQuery,\n        onSearchChange: this.handleSearchChange,\n        loading: loadingSearch,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 310\n        },\n        __self: this\n      }), degree === 'PhD' && React.createElement(React.Fragment, null, React.createElement(\"div\", {\n        className: css(styles.EducationEditModal_modalFieldLabel),\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 328\n        },\n        __self: this\n      }, \"Field of Study\"), React.createElement(\"div\", {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 331\n        },\n        __self: this\n      }, React.createElement(\"input\", {\n        className: css(styles.EducationEditModal_modalTextInput),\n        type: \"text\",\n        value: fieldOfStudy,\n        onChange: function onChange(e) {\n          return _this2.handleChange(e, 'fieldOfStudy');\n        },\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 332\n        },\n        __self: this\n      }))), React.createElement(\"input\", {\n        className: css(styles.EducationEditModal_modalTextInput),\n        type: \"hidden\",\n        value: degree || '',\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 341\n        },\n        __self: this\n      }), React.createElement(\"div\", {\n        style: {\n          width: '48%',\n          marginRight: '4%',\n          display: 'inline-block'\n        },\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 346\n        },\n        __self: this\n      }, React.createElement(\"div\", {\n        className: css(styles.EducationEditModal_modalFieldLabel),\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 347\n        },\n        __self: this\n      }, \"Start Year\"), React.createElement(Dropdown, {\n        className: css(styles.EducationEditModal_dropdown),\n        icon: \"chevron down\",\n        fluid: true,\n        selection: true,\n        placeholder: \"Start Year\",\n        value: startYear || '',\n        options: yearOptions,\n        onChange: function onChange(e, selection) {\n          return _this2.handleYears(e, selection, 'startYear');\n        },\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 350\n        },\n        __self: this\n      })), React.createElement(\"div\", {\n        style: {\n          width: '48%',\n          display: 'inline-block'\n        },\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 361\n        },\n        __self: this\n      }, React.createElement(\"div\", {\n        className: css(styles.EducationEditModal_modalFieldLabel),\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 362\n        },\n        __self: this\n      }, \"End Year\"), React.createElement(Dropdown, {\n        className: css(styles.EducationEditModal_dropdown),\n        icon: \"chevron down\",\n        fluid: true,\n        selection: true,\n        placeholder: \"End Year\",\n        value: endYear || '',\n        options: [{\n          key: 'Present',\n          text: 'Present',\n          value: 'Present'\n        }].concat(yearOptions),\n        onChange: function onChange(e, selection) {\n          return _this2.handleYears(e, selection, 'endYear');\n        },\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 365\n        },\n        __self: this\n      })), React.createElement(\"div\", {\n        className: css(styles.EducationEditModal_modalButtonHolder),\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 376\n        },\n        __self: this\n      }, inEditMode && React.createElement(Button, {\n        className: css(modalStyles.Modal_deleteButton),\n        type: \"submit\",\n        onClick: this.deleteEducation,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 378\n        },\n        __self: this\n      }, \"Delete\"), React.createElement(Button, {\n        className: css(styles.EducationEditModal_modalCancelButton),\n        type: \"submit\",\n        onClick: closeModal,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 386\n        },\n        __self: this\n      }, \"Cancel\"), React.createElement(Button, {\n        className: css(styles.EducationEditModal_modalSubmitButton),\n        type: \"submit\",\n        disabled: !validEducation,\n        onClick: this.handleSubmitMessage,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 393\n        },\n        __self: this\n      }, isNew ? 'Add' : 'Save'))));\n    }\n  }]);\n\n  return EducationEditModal;\n}(PureComponent);\n\nEducationEditModal.propTypes = {\n  education: PropTypes.object,\n  open: PropTypes.bool,\n  closeModal: PropTypes.func\n};\nexport default EducationEditModal;","map":{"version":3,"sources":["/Volumes/Work/work/dev/project/projects/halo/app/javascript/src/marketplace/components/Sidebar/EducationEditModal.jsx"],"names":["React","PureComponent","PropTypes","connect","css","StyleSheet","Modal","Button","Dropdown","moment","_","debounce","COLORS","styles","modalStyles","authenticityToken","create","EducationEditModal_modal","overflow","EducationEditModal_modalHeader","fontWeight","fontSize","lineHeight","color","lightBlack","marginBottom","EducationEditModal_modalFieldLabel","textAlign","margin","width","labelGray","EducationEditModal_modalTextInput","padding","borderStyle","borderWidth","borderColor","gray","EducationEditModal_modalSubmitButton","background","lightBlue","backgroundImage","display","height","white","EducationEditModal_modalButtonHolder","marginTop","EducationEditModal_modalCancelButton","backgroundColor","EducationEditModal_dropdown","alignItems","yearOptions","range","Date","getFullYear","map","year","key","text","value","String","EducationEditModal","props","fetchUniversities","setState","loadingUniversities","fetch","method","headers","response","json","responseJson","universities","universityOptions","handleSubmitMessage","e","closeModal","degree","preventDefault","state","location","startYear","endYear","isNew","fieldOfStudy","educationEditModalLoading","education","formData","FormData","append","id","body","educationResponse","success","window","reload","handleChange","attr","target","handleYears","selection","handleLocation","searchQuery","handleSearchQuery","options","query","uniqBy","concat","filter","university","length","universitySearch","name","loadingSearch","leading","trailing","handleSearchChange","deleteEducation","confirm","isEmpty","start_year","end_year","field_of_study","prevProps","open","validEducation","inEditMode","marginRight","Modal_deleteButton","propTypes","object","bool","func"],"mappings":"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","sourcesContent":["import React, { PureComponent } from 'react';\nimport PropTypes from 'prop-types';\nimport { connect } from 'react-redux';\nimport { css, StyleSheet } from 'aphrodite';\nimport { Modal, Button, Dropdown } from 'semantic-ui-react';\nimport moment from 'moment';\nimport _, { debounce } from 'lodash';\nimport { COLORS } from '../../../../constants';\nimport { styles as modalStyles } from '../Modal'\nimport {\n  authenticityToken,\n} from '../../utils/requests';\n\nconst styles = StyleSheet.create({\n  EducationEditModal_modal: {\n    overflow: 'visible',\n  },\n  EducationEditModal_modalHeader: {\n    fontWeight: 500,\n    fontSize: '24px',\n    lineHeight: '32px',\n    color: COLORS.lightBlack,\n    marginBottom: '32px',\n  },\n  EducationEditModal_modalFieldLabel: {\n    textAlign: 'left',\n    margin: '10px 0 6px',\n    width: '100%',\n    fontSize: '12px',\n    fontWeight: 500,\n    lineHeight: '16px',\n    color: COLORS.labelGray,\n  },\n  EducationEditModal_modalTextInput: {\n    width: '100%',\n    margin: 'auto',\n    padding: '10px',\n    fontSize: '14px',\n    lineHeight: '20px',\n    borderStyle: 'solid',\n    borderWidth: '1px',\n    color: COLORS.lightBlack,\n    borderColor: COLORS.gray,\n  },\n  EducationEditModal_modalSubmitButton: {\n    background: COLORS.lightBlue,\n    backgroundImage: 'linear-gradient(134.72deg, #4E9DF5 0%, #48B2F4 100%)',\n    display: 'inline-block',\n    height: '48px',\n    textAlign: 'center',\n    color: COLORS.white,\n    fontSize: '14px',\n    fontWeight: 500,\n    lineHeight: '20px',\n    padding: '5px 50px',\n  },\n  EducationEditModal_modalButtonHolder: {\n    width: '100%',\n    display: 'inline-block',\n    textAlign: 'right',\n    marginTop: '36px',\n  },\n  EducationEditModal_modalCancelButton: {\n    height: '48px',\n    textAlign: 'center',\n    color: COLORS.lightBlack,\n    backgroundColor: COLORS.white,\n    display: 'inline-block',\n    fontSize: '14px',\n    fontWeight: 500,\n    lineHeight: '20px',\n    padding: '5px 50px',\n  },\n  EducationEditModal_dropdown: {\n    width: '100%',\n    display: 'flex',\n    height: '48px',\n    alignItems: 'center',\n    borderStyle: 'solid',\n    borderWidth: '1px',\n    borderColor: COLORS.gray,\n    margin: 'auto',\n    fontSize: '14px',\n  },\n});\n\nconst yearOptions = _.range(new Date().getFullYear(), 1950, -1).map((year) => {\n  return {\n    key: year,\n    text: year,\n    value: String(year),\n  };\n});\n\nclass EducationEditModal extends PureComponent {\n  constructor(props) {\n    super(props);\n\n    const education = props.education || {};\n    this.state = {\n      isNew: _.isEmpty(education),\n      educationEditModalLoading: false,\n      loadingUniversities: false,\n      universityOptions: education.location ? [{ key: education.location, value: education.location, text: education.location }] : [],\n      location: education.location,\n      startYear: education.start_year,\n      endYear: education.end_year,\n      searchQuery: education.location ? education.location : '',\n      fieldOfStudy: education.field_of_study,\n    };\n  }\n\n  componentDidUpdate(prevProps) {\n    if (prevProps.education !== this.props.education) {\n      const education = this.props.education || {};\n      this.setState({\n        isNew: _.isEmpty(education),\n        universityOptions: education.location ? [{ key: education.location, value: education.location, text: education.location }] : [],\n        location: education.location,\n        startYear: education.start_year,\n        endYear: education.end_year,\n        searchQuery: education.location ? education.location : '',\n        fieldOfStudy: education.field_of_study,\n      });\n    }\n  }\n\n  fetchUniversities = async () => {\n    this.setState({ loadingUniversities: true });\n    const response = await fetch('/universities', {\n      method: 'GET',\n      headers: {\n        'Accept': 'application/json',\n      }\n    });\n    const responseJson = await response.json();\n    const universities = responseJson.universities;\n\n    this.setState({\n      universityOptions: universities,\n      loadingUniversities: false,\n    });\n  }\n\n  handleSubmitMessage = async (e) => {\n    const {\n      closeModal,\n      degree,\n    } = this.props;\n\n    e.preventDefault();\n\n    const {\n      location,\n      startYear,\n      endYear,\n      isNew,\n      fieldOfStudy,\n    } = this.state;\n\n    this.setState({\n      educationEditModalLoading: true,\n    });\n\n    const education = this.props.education || {};\n\n    const formData = new FormData();\n    formData.append('location', location);\n    if (degree) {\n      formData.append('degree', degree);\n    }\n    if (startYear) {\n      formData.append('start_year', startYear);\n    }\n    if (endYear) {\n      formData.append('end_year', endYear);\n    }\n    if (fieldOfStudy) {\n      formData.append('field_of_study', fieldOfStudy);\n    }\n\n    try {\n      const educationResponse = await fetch(\n        isNew ? '/educations' : `/educations/${education.id}`,\n        {\n          method: isNew ? 'POST' : 'PUT',\n          body: formData,\n          headers: {\n            'Accept': 'application/json',\n            'X-CSRF-Token': authenticityToken(),\n          }\n        }\n      );\n      const responseJson = await educationResponse.json();\n      if (!responseJson.success) {\n        this.setState({\n          educationEditModalLoading: false,\n        });\n      } else {\n        this.setState({\n          educationEditModalLoading: false,\n        });\n        window.location.reload();\n      }\n    } catch(err) {\n      this.setState({ educationEditModalLoading: false });\n    }\n  }\n\n  handleChange = (e, attr) => {\n    this.setState({ [attr]: e.target.value });\n  };\n\n  handleYears = (e, selection, attr) => {\n    this.setState({ [attr]: selection.value });\n  };\n\n  handleLocation = (e, selection) => {\n    this.setState({\n      searchQuery: selection.value,\n      location: selection.value,\n    });\n  };\n\n  handleSearchQuery = (options, query) => {\n    const { universityOptions, location } = this.state;\n    return _.uniqBy(\n      [{ key: location, text: location, value: location }].concat(universityOptions), 'value')\n      .filter(university => university.value && university.value.length > 0);\n  }\n\n  universitySearch = debounce(async (name) => {\n    this.setState({ loadingSearch: true });\n    const response = await fetch(`/universities/search?name=${name}`, {\n      method: 'GET',\n      headers: {\n        'Accept': 'application/json',\n      }\n    });\n    const responseJson = await response.json();\n    const universities = responseJson.universities;\n\n    this.setState({\n      location: '',\n      universityOptions: universities,\n      loadingSearch: false,\n    });\n  }, 500, { leading: true, trailing: true });\n\n  handleSearchChange = async (e, { searchQuery }) => {\n    this.universitySearch(searchQuery);\n\n    this.setState({\n      searchQuery,\n    });\n  };\n\n  deleteEducation = async () => {\n    if (confirm(\"Are you sure you want to delete that?\")) {\n      await fetch(`/educations/${this.props.education.id}`, {\n        method: 'DELETE',\n        headers: {\n          'Accept': 'application/json',\n          'X-CSRF-Token': authenticityToken(),\n        }\n      });\n      window.location.reload();\n    }\n  }\n\n  render() {\n    const {\n      open,\n      degree,\n      closeModal,\n      education\n    } = this.props;\n\n    const {\n      location,\n      startYear,\n      endYear,\n      loadingUniversities,\n      universityOptions,\n      isNew,\n      educationEditModalLoading,\n      loadingSearch,\n      searchQuery,\n      fieldOfStudy,\n    } = this.state;\n\n    const validEducation = location && !loadingUniversities && !educationEditModalLoading;\n    const inEditMode = !!education;\n\n    return (\n      <Modal\n        open={open}\n        onClose={closeModal}\n        size=\"small\"\n        closeOnDimmerClick={false}\n        className={`${css(styles.EducationEditModal_modal)} scrolling`}\n      >\n        <Modal.Content>\n          <div className={css(styles.EducationEditModal_modalHeader)}>\n            Add {degree === 'Postdoctoral Scientist' ? \"Postdoc\" : degree}\n          </div>\n          <div className={css(styles.EducationEditModal_modalFieldLabel)}>\n            Research Institution\n          </div>\n          <Dropdown\n            className={css(styles.EducationEditModal_dropdown)}\n            fluid\n            selection\n            icon={null}\n            placeholder={\"Search research institutions\"}\n            open={universityOptions.length > 0 && !location}\n            closeOnChange\n            search={this.handleSearchQuery}\n            value={location || ''}\n            options={universityOptions}\n            onChange={this.handleLocation}\n            searchQuery={searchQuery}\n            onSearchChange={this.handleSearchChange}\n            loading={loadingSearch}\n          />\n          {degree === 'PhD' && (\n            <>\n              <div className={css(styles.EducationEditModal_modalFieldLabel)}>\n                Field of Study\n              </div>\n              <div>\n               <input\n                  className={css(styles.EducationEditModal_modalTextInput)}\n                  type='text'\n                  value={fieldOfStudy}\n                  onChange={(e) => this.handleChange(e, 'fieldOfStudy')}\n                />\n              </div>\n            </>\n          )}\n          <input\n            className={css(styles.EducationEditModal_modalTextInput)}\n            type=\"hidden\"\n            value={degree || ''}\n          />\n          <div style={{ width: '48%', marginRight: '4%', display: 'inline-block' }}>\n            <div className={css(styles.EducationEditModal_modalFieldLabel)}>\n              Start Year\n            </div>\n            <Dropdown\n              className={css(styles.EducationEditModal_dropdown)}\n              icon=\"chevron down\"\n              fluid\n              selection\n              placeholder=\"Start Year\"\n              value={startYear || ''}\n              options={yearOptions}\n              onChange={(e, selection) => this.handleYears(e, selection, 'startYear')}\n            />\n          </div>\n          <div style={{ width: '48%', display: 'inline-block' }}>\n            <div className={css(styles.EducationEditModal_modalFieldLabel)}>\n              End Year\n            </div>\n            <Dropdown\n              className={css(styles.EducationEditModal_dropdown)}\n              icon=\"chevron down\"\n              fluid\n              selection\n              placeholder=\"End Year\"\n              value={endYear || ''}\n              options={[{ key: 'Present', text: 'Present', value: 'Present'}].concat(yearOptions)}\n              onChange={(e, selection) => this.handleYears(e, selection, 'endYear')}\n            />\n          </div>\n          <div className={css(styles.EducationEditModal_modalButtonHolder)}>\n            {inEditMode &&\n              <Button\n                className={css(modalStyles.Modal_deleteButton)}\n                type='submit'\n                onClick={this.deleteEducation}\n                >\n                Delete\n              </Button>\n            }\n            <Button\n              className={css(styles.EducationEditModal_modalCancelButton)}\n              type='submit'\n              onClick={closeModal}\n            >\n              Cancel\n            </Button>\n            <Button\n              className={css(styles.EducationEditModal_modalSubmitButton)}\n              type='submit'\n              disabled={!validEducation}\n              onClick={this.handleSubmitMessage}\n            >\n              {isNew ? 'Add' : 'Save'}\n            </Button>\n          </div>\n        </Modal.Content>\n      </Modal>\n    );\n  }\n}\n\nEducationEditModal.propTypes = {\n  education: PropTypes.object,\n  open: PropTypes.bool,\n  closeModal: PropTypes.func,\n};\n\nexport default EducationEditModal;\n"]},"metadata":{},"sourceType":"module"}